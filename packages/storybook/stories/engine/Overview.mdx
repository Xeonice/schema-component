import { Meta } from '@storybook/blocks'

<Meta title="Engine/Overview" />

# @schema-component/engine

@schema-component/engine 是一个强大的、模块化的引擎系统，为 schema-component 项目提供核心功能支持。

## 🎯 核心特性

### 模块化架构
引擎采用分层、模块化设计，每个模块独立且可组合使用：

- **Core** - 核心模型系统，支持声明式模型定义
- **DI** - 依赖注入容器，管理服务生命周期
- **Event** - 事件总线，实现组件间解耦通信
- **HTTP** - HTTP 客户端，支持拦截器和重试逻辑
- **State** - 状态管理，基于 MobX 的响应式状态
- **Repository** - 仓储模式，抽象数据访问层
- **Render** - 渲染系统，支持多层渲染架构

### 函数式优先
所有核心 API 都采用函数式设计：
- APIs/Actions/Views 都是可执行函数
- 支持函数组合和高阶函数
- 类型安全且易于测试

### 类型安全
完整的 TypeScript 支持：
- 严格的类型检查
- 智能的类型推导
- 优秀的 IDE 支持

## 📖 快速开始

```typescript
import { createEngineContext } from '@schema-component/engine'

// 创建引擎上下文
const engine = createEngineContext({
  apiBaseUrl: 'https://api.example.com',
  debug: true
})

// 初始化
await engine.initialize()

// 使用 DI 容器
const service = engine.get(SERVICE_TYPE)

// 使用事件总线
const eventBus = engine.getEventBus()
eventBus.subscribe('event:type', handler)
```

## 🏗️ 架构概览

```
┌─────────────────────────────────────────────┐
│            Application Layer                │
├─────────────────────────────────────────────┤
│                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │  Render  │  │  State   │  │   HTTP   │ │
│  │  Layer   │  │  Layer   │  │  Client  │ │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘ │
│       │             │             │        │
├───────┼─────────────┼─────────────┼────────┤
│       │             │             │        │
│  ┌────▼─────┐  ┌───▼──────┐  ┌───▼──────┐ │
│  │ Repository│  │  Event   │  │    DI    │ │
│  │  Pattern  │  │   Bus    │  │Container │ │
│  └────┬──────┘  └────┬─────┘  └────┬─────┘ │
│       │              │             │        │
├───────┼──────────────┼─────────────┼────────┤
│       └──────────────┴─────────────┘        │
│              ┌────────────────┐             │
│              │  Core Engine   │             │
│              │ Model Registry │             │
│              └────────────────┘             │
└─────────────────────────────────────────────┘
```

## 📚 模块导览

### [Core](/docs/engine-core-overview)
核心模型系统，提供模型定义、注册和执行能力。

**主要功能**:
- `defineModel` - 定义模型
- `ModelRegistry` - 模型注册管理
- `ModelExecutor` - 模型执行器
- `EngineContext` - 引擎上下文

### [DI (Dependency Injection)](/docs/engine-di-overview)
依赖注入容器，管理服务的创建和生命周期。

**主要功能**:
- Service 绑定和解析
- Singleton/Transient 生命周期
- 装饰器支持 (`@Injectable`, `@Inject`)

### [Event](/docs/engine-event-overview)
类型安全的事件总线系统。

**主要功能**:
- 发布/订阅模式
- 事件优先级
- 通配符订阅
- 事件历史追踪

### [HTTP](/docs/engine-http-overview)
功能丰富的 HTTP 客户端。

**主要功能**:
- 请求/响应拦截器
- 自动重试机制
- 超时控制
- REST API 包装器

### [State](/docs/engine-state-overview)
基于 MobX 的响应式状态管理。

**主要功能**:
- `ModelStore` - 模型状态存储
- 自动派生计算
- 响应式更新
- 与模型系统无缝集成

### [Repository](/docs/engine-repository-overview)
数据访问抽象层。

**主要功能**:
- 统一的 CRUD 接口
- HTTP Repository 实现
- Mock Repository（用于测试）
- 自定义 Repository 支持

### [Render](/docs/engine-render-overview)
多层渲染架构系统。

**主要功能**:
- `RenderEngine` - 渲染引擎核心
- `ActionQueue` - 优先级动作队列
- `ViewStack` - 视图栈管理
- 三层渲染架构（Static/Dynamic/Effects）

## 🧪 示例代码

查看左侧导航栏中的各个模块，探索交互式示例：

- **Getting Started** - 快速入门示例
- **Core Examples** - 核心模块示例
- **DI Examples** - 依赖注入示例
- **Event Examples** - 事件系统示例
- **HTTP Examples** - HTTP 客户端示例
- **State Examples** - 状态管理示例
- **Repository Examples** - 仓储模式示例
- **Render Examples** - 渲染系统示例

## 📖 设计文档

深入了解引擎的架构设计：

- [渲染架构设计](/docs/engine-docs-renderarchitecture)
- [渲染详细设计](/docs/engine-docs-renderdesign)
- [渲染分层设计](/docs/engine-docs-renderlayerdesign)
- [Action 渲染器设计](/docs/engine-docs-actionrendererdesign)

## 🔗 相关链接

- [GitHub Repository](https://github.com/Xeonice/schema-component)
- [API 参考文档](#)
- [完整示例代码](https://github.com/Xeonice/schema-component/tree/main/packages/engine/examples)
