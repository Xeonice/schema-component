import { Meta } from '@storybook/blocks'

<Meta title="Project/Contributing" />

# 贡献指南

感谢你对 Schema Component 项目的关注！我们欢迎各种形式的贡献。

## 🤝 如何贡献

### 贡献类型

#### 1. 报告 Bug 🐛

如果你发现了 Bug，请：

1. 检查 [Issues](https://github.com/Xeonice/schema-component/issues) 确认问题是否已被报告
2. 如果没有，创建新 Issue，包含：
   - 清晰的标题和描述
   - 复现步骤
   - 期望行为 vs 实际行为
   - 环境信息（Node版本、操作系统等）
   - 相关代码片段或截图

#### 2. 功能建议 💡

想要新功能？请：

1. 先在 [Discussions](https://github.com/Xeonice/schema-component/discussions) 讨论
2. 描述清楚：
   - 功能的使用场景
   - 为什么需要这个功能
   - 提供示例代码（如果可能）

#### 3. 文档改进 📝

文档贡献同样重要！你可以：

- 修正拼写或语法错误
- 改进现有文档的清晰度
- 添加缺失的文档
- 更新过时的信息
- 添加更多示例

#### 4. 代码贡献 🔨

提交代码请遵循下面的流程。

## 🚀 开发流程

### 1. 准备开发环境

#### 必要工具

- **Node.js**: >= 16.0.0
- **pnpm**: >= 8.0.0
- **Git**: 最新稳定版

#### 克隆仓库

```bash
git clone https://github.com/Xeonice/schema-component.git
cd schema-component
```

#### 安装依赖

```bash
pnpm install
```

### 2. 创建分支

从 `main` 分支创建新的功能分支：

```bash
git checkout -b feature/your-feature-name
# or
git checkout -b fix/your-bug-fix
```

**分支命名规范**:

- `feature/` - 新功能
- `fix/` - Bug 修复
- `docs/` - 文档改进
- `refactor/` - 代码重构
- `test/` - 测试相关
- `chore/` - 杂项（构建、配置等）

### 3. 开发

#### 启动开发环境

```bash
# 启动所有包的 watch 模式
pnpm run dev

# 启动 Storybook（用于查看组件和文档）
pnpm storybook
```

#### 运行测试

```bash
# 运行所有测试
pnpm test

# Watch 模式
pnpm test:watch

# 生成覆盖率报告
pnpm test:coverage
```

#### 代码规范

项目使用 ESLint 和 Prettier 来保证代码质量：

```bash
# 检查代码规范
pnpm lint

# 自动修复
pnpm lint:fix

# 格式化代码
pnpm format
```

### 4. 提交代码

#### Commit 消息规范

我们使用 [Conventional Commits](https://www.conventionalcommits.org/) 规范：

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type**:
- `feat`: 新功能
- `fix`: Bug 修复
- `docs`: 文档改动
- `style`: 代码格式（不影响代码运行）
- `refactor`: 重构
- `test`: 测试相关
- `chore`: 构建过程或辅助工具的变动

**示例**:

```bash
git commit -m "feat(engine): add GraphQL client support"
git commit -m "fix(schema): resolve type inference issue for nested fields"
git commit -m "docs(storybook): add HTTP client examples"
```

### 5. 创建 Pull Request

#### 推送到 GitHub

```bash
git push origin feature/your-feature-name
```

#### 创建 PR

1. 访问 [Pull Requests](https://github.com/Xeonice/schema-component/pulls)
2. 点击 "New Pull Request"
3. 填写 PR 描述：
   - 清晰描述改动内容
   - 关联相关 Issue（如果有）
   - 添加测试截图或示例（如果适用）
   - 标注是否为破坏性更新

#### PR 模板

```markdown
## 描述
简要描述这个 PR 做了什么改动。

## 改动类型
- [ ] Bug 修复
- [ ] 新功能
- [ ] 文档更新
- [ ] 代码重构
- [ ] 性能优化
- [ ] 测试相关

## 相关 Issue
Closes #(issue number)

## 测试
描述你如何测试了这些改动：
- [ ] 单元测试通过
- [ ] 集成测试通过
- [ ] 手动测试通过

## 截图（如果适用）

## Checklist
- [ ] 我的代码遵循了项目的代码规范
- [ ] 我已经进行了自我审查
- [ ] 我已经注释了代码中难以理解的部分
- [ ] 我已经更新了相关文档
- [ ] 我的改动没有产生新的警告
- [ ] 我已经添加了测试来证明我的修复/功能有效
- [ ] 新增和现有的单元测试都通过
```

## 📋 开发规范

### TypeScript

- 启用严格模式
- 提供完整的类型定义
- 避免使用 `any`
- 导出的 API 必须有 JSDoc 注释

### 测试

- 新功能必须包含测试
- Bug 修复应包含回归测试
- 保持测试覆盖率 > 80%
- 使用描述性的测试名称

### 文档

- 公共 API 必须有文档
- 复杂逻辑需要注释说明
- README 需要保持更新
- 考虑在 Storybook 中添加示例

### 性能

- 避免不必要的重新渲染
- 使用适当的数据结构
- 大数据集考虑虚拟滚动
- 异步操作使用防抖/节流

## 🔍 Code Review 流程

### 提交 PR 后

1. **自动检查**: CI 会自动运行测试和 Lint
2. **人工审查**: 维护者会审查你的代码
3. **反馈循环**: 根据反馈进行修改
4. **批准合并**: 审查通过后会被合并

### 审查标准

我们会关注：

- ✅ 代码质量和可读性
- ✅ 测试覆盖和质量
- ✅ 文档完整性
- ✅ 性能影响
- ✅ 向后兼容性
- ✅ 安全性

## 🎨 Storybook 贡献

### 添加新的 Story

```typescript
import type { Meta, StoryObj } from '@storybook/react'
import React from 'react'

// 你的组件
const YourComponent: React.FC<Props> = (props) => {
  // ...
}

const meta: Meta<typeof YourComponent> = {
  title: 'Category/YourComponent',
  component: YourComponent,
  tags: ['autodocs'],
  parameters: {
    layout: 'padded',
    docs: {
      description: {
        component: '组件描述'
      }
    }
  }
}

export default meta
type Story = StoryObj<typeof YourComponent>

export const Default: Story = {
  args: {
    // 默认 props
  }
}
```

### MDX 文档

```mdx
import { Meta } from '@storybook/blocks'

<Meta title="Category/Documentation" />

# 文档标题

你的文档内容...
```

## 🆘 需要帮助？

- 💬 [GitHub Discussions](https://github.com/Xeonice/schema-component/discussions) - 提问和讨论
- 🐛 [Issues](https://github.com/Xeonice/schema-component/issues) - 报告问题
- 📧 Email - 联系维护者

## 🙏 致谢

感谢所有为项目做出贡献的开发者！

你的贡献让 Schema Component 变得更好！ ❤️

---

**最后更新**: 2025-10-31
