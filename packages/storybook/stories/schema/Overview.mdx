import { Meta } from '@storybook/blocks'

<Meta title="Schema/Overview" />

# Schema åŒ…æ¦‚è¿°

`@schema-component/schema` æ˜¯ Schema Component çš„æ ¸å¿ƒåŒ…ï¼Œæä¾›å¼ºå¤§çš„ Schema å®šä¹‰å’ŒéªŒè¯åŠŸèƒ½ã€‚

## æ ¸å¿ƒæ¦‚å¿µ

### Schema å®šä¹‰

Schema æ˜¯æ•°æ®æ¨¡å‹çš„è“å›¾ï¼Œå®šä¹‰äº†ï¼š

- **å­—æ®µç±»å‹**: åŸºç¡€å­—æ®µå’Œå…³è”å­—æ®µ
- **éªŒè¯è§„åˆ™**: æ•°æ®éªŒè¯é€»è¾‘
- **å…³ç³»å®šä¹‰**: æ¨¡å‹é—´çš„å…³è”å…³ç³»
- **ç±»å‹æ¨å¯¼**: è‡ªåŠ¨çš„ TypeScript ç±»å‹

### å­—æ®µç±»å‹

#### åŸºç¡€å­—æ®µ (8 ç§)

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **String** | å­—ç¬¦ä¸² | `field.string()` |
| **Number** | æ•°å€¼ | `field.integer()`, `field.float()` |
| **Boolean** | å¸ƒå°”å€¼ | `field.boolean()` |
| **Date** | æ—¥æœŸæ—¶é—´ | `field.date()`, `field.timestamp()` |
| **Enum** | æšä¸¾ | `field.enum({ values: [...] })` |
| **JSON** | JSON å¯¹è±¡ | `field.json()` |
| **Array** | æ•°ç»„ | `field.array({ items: ... })` |
| **Binary** | äºŒè¿›åˆ¶ | `field.binary()` |

#### å…³è”å­—æ®µ (4 ç§)

| å…³ç³» | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **One-to-One** | ä¸€å¯¹ä¸€ | `relation.one('Profile')` |
| **One-to-Many** | ä¸€å¯¹å¤š | `relation.many('Post')` |
| **Many-to-One** | å¤šå¯¹ä¸€ | `relation.belongsTo('User')` |
| **Many-to-Many** | å¤šå¯¹å¤š | `relation.manyToMany('Tag')` |

## å¿«é€Ÿç¤ºä¾‹

### å®šä¹‰ User Schema

```typescript
import { defineSchema, field, relation } from '@schema-component/schema'

const UserSchema = defineSchema('User', {
  id: field.uuid({ primary: true }),
  username: field.string({ required: true, unique: true }),
  email: field.email({ required: true, unique: true }),
  age: field.integer({ min: 0, max: 150 }),
  status: field.enum({
    values: ['active', 'inactive', 'banned'] as const,
    default: 'active'
  }),

  // æ—¶é—´æˆ³
  createdAt: field.timestamp({ autoCreate: true }),
  updatedAt: field.timestamp({ autoUpdate: true }),

  // å…³è”
  profile: relation.one('Profile'),
  posts: relation.many('Post', { foreignKey: 'authorId' })
})
```

### éªŒè¯æ•°æ®

```typescript
const result = UserSchema.safeParse({
  username: 'john_doe',
  email: 'john@example.com',
  age: 25
})

if (result.success) {
  console.log(result.data) // ç±»å‹å®‰å…¨çš„æ•°æ®
} else {
  console.error(result.errors) // éªŒè¯é”™è¯¯
}
```

### ç±»å‹æ¨å¯¼

```typescript
import { Infer } from '@schema-component/schema'

type User = Infer<typeof UserSchema>
// è‡ªåŠ¨æ¨å¯¼ä¸º:
// {
//   id: string
//   username: string
//   email: string
//   age?: number
//   status?: 'active' | 'inactive' | 'banned'
//   createdAt: Date
//   updatedAt: Date
//   profile?: Profile
//   posts?: Post[]
// }
```

## æ ¸å¿ƒç‰¹æ€§

### ğŸ”’ ç±»å‹å®‰å…¨

å®Œæ•´çš„ TypeScript ç±»å‹æ¨å¯¼ï¼Œç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ã€‚

### âœ… å¼ºå¤§éªŒè¯

åŸºäº Zod çš„éªŒè¯ç³»ç»Ÿï¼Œæ”¯æŒåŒæ­¥/å¼‚æ­¥éªŒè¯ã€‚

### ğŸ”— å…³è”å…³ç³»

æ”¯æŒæ‰€æœ‰å¸¸è§çš„æ•°æ®åº“å…³ç³»ç±»å‹ã€‚

### ğŸ¯ çµæ´»é…ç½®

é€šè¿‡ `withOption` å‡½æ•°çµæ´»é…ç½®å­—æ®µé€‰é¡¹ã€‚

### ğŸ“¦ æ ‡å‡†å…¼å®¹

æ”¯æŒå¯¼å‡ºä¸º JSON Schemaã€OpenAPIã€Prisma ç­‰æ ‡å‡†æ ¼å¼ã€‚

## æ·±å…¥å­¦ä¹ 

æ¢ç´¢æ›´å¤šå†…å®¹ï¼š

- [Basic Fields](/?path=/docs/schema-basic-fields--docs) - åŸºç¡€å­—æ®µè¯¦è§£
- [Relation Fields](/?path=/docs/schema-relation-fields--docs) - å…³è”å­—æ®µè¯¦è§£
- [Validation](/?path=/docs/schema-validation--docs) - éªŒè¯ç³»ç»Ÿ
- [Type Inference](/?path=/docs/schema-type-inference--docs) - ç±»å‹æ¨å¯¼

## API å‚è€ƒ

æŸ¥çœ‹å®Œæ•´çš„ [Schema API æ–‡æ¡£](/?path=/docs/api-schema-api--docs)ã€‚

---

**æŠ€æœ¯æ ˆ**: åŸºäº Zod æ„å»ºï¼Œæä¾›æˆç†Ÿç¨³å®šçš„éªŒè¯åŠŸèƒ½ã€‚
